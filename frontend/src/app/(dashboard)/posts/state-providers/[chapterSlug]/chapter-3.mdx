import { Example } from '/src/snippets/components/Example';

# State providers

In general, React components that are on the same page in the application tend to need the same data.
Therefore, I've adopted the approach of loading all data for all components on a page in a special component
called a `StateProvider`. This component provides the data to all of its children via React's `context` API.
I prefer this to letting components fetch their own data, for different reasons:

- It keeps the components simple and focused on rendering;
- It prevents synchronization problems with components fetching data at different times;
- It makes it easy to share (more complex) state between components.

## Example

Before we discuss at the `StateProvider` component in detail, let's look at how it is used
in the rendering tree. We'll do so by continuing the example that was used in the previous chapter,
where the user has a user-profile that contains a list of todo-lists.
The user profile will also store some user preferences. Finally, let's assume that
when the user-profile is loaded, it loads the todo-lists but not the individual
todo's in each list.

The example code shows a `UserProfileStateProvider` component that is responsible for fetching the
user profile and providing it to `TodolistsStateProvider` and `UserPreferencesView` (and to all other
components that are wrapped in this state provider). The `TodolistsStateProvider` will load the individual todo's
of the currently highlighted list, and provide this information to the `TodoListsView` component.

Note that although `StateProvider` components are technically React components,
they are not responsible for rendering.

export const code1 = `
export const UrlRouter = observer((props: PropsT) => {
  return (
    <Switch>
      <UserProfileStateProvider>
        <Route path="/todo-lists">
          <TodoListsStateProvider>
            <TodoListsView />
          </TodoListsStateProvider>
        </Route>
        <Route path="/preferences">
          <UserPreferencesView />
        </Route>
      </UserProfileStateProvider>
    </Switch>
  );
});
`;

In the next section, we'll look at the implementation of the `UserProfileStateProvider` component and
the `TodoListsStateProvider` component.